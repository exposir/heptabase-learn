<!--
- [INPUT]: Monorepo Tools, Component Library Design, CLI Frameworks, AST (Babel/ESLint)
- [OUTPUT]: 工程基础设施设计、工具链开发及代码自动化重构的要求
- [POS]: 编程题/ 复杂场景专题，聚焦提效工具与中大型项目架构
- [PROTOCOL]: 变更时更新此头部，然后检查 CLAUDE.md
-->

# 3.5 工程架构

工程架构专题考察开发者如何通过工具化与规范化，提升大规模团队的研发效率与系统稳定性。

---

### 3.5.1 Monorepo 管理与构建 ⭐⭐⭐

**要求：** 设计一个支撑多包 (Packages) 协作的工程化方案。

- **核心挑战：**
  - **依赖管理策略**：解决 Phantom dependencies 与依赖地狱（pnpm workspace 实践）。
  - **版本发布流**：Changesets 或 Lerna 在自动化版本提升中的应用。
  - **增量构建 (Incremental Build)**：利用本地/远程缓存提升 CI 速度（Turborepo 机制）。
  - **CI/CD 优化**：基于变更范围的代码扫描与并行测试任务调度。

---

### 3.5.2 企业级组件库设计 ⭐⭐⭐⭐

**要求：** 从零构建一套符合工业标准的基础组件系统。

- **关键要素：**
  - **API 设计原则**：关注点的分离、属性透传与受控 vs 非受控的一致性。
  - **主题系统 (Theming)**：基于 CSS Variables 或 Design Tokens 的多主题实时切换。
  - **按需加载方案**：Tree-shaking 友好性与分包导出策略。
  - **自动化文档系统**：结合 Storybook 或 VitePress 的交互式组件演示。

---

### 3.5.3 CLI 脚手架工具开发 ⭐⭐⭐

**要求：** 针对业务场景定制开发一套代码生成与环境初始化的命令行工具。

- **技术栈要求：**
  - **指令解析**：Commander/Yargs 的高级交互式配置。
  - **交互体验**：Inquirer/Enquirer 在复杂参数收集中的应用。
  - **模板引擎**：Handlebars/EJS 在代码动态生成中的逻辑处理。
  - **插件机制**：如何利用 Tapable 或 Middleware 实现脚手架的高度可扩展。

---

### 3.5.4 AST 应用与代码重构 ⭐⭐⭐⭐

**要求：** 利用抽象语法树 (AST) 进行代码的静态分析、转换与自动修复。

- **实战场景：**
  - **Babel 插件定制**：实现特定语法的转换或代码埋点。
  - **ESLint 规则开发**：编写符合团队规范的静态检测逻辑。
  - **Codemod 自动化重构**：针对 API 破坏性升级的自动迁移脚本。
  - **代码生成与注入**：基于 AST 的组件元数据提取与文档自动同步。

---

## 质量指标

- **扩展性**：工具链是否采用了松耦合的插件化设计。
- **易用性**：CLI 交互是否直观，报错是否具备明确的行动导向。
- **稳定性**：自动化工具是否通过了完备的边缘情况单测 (Unit Testing)。
